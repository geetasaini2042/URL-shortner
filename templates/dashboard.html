{% extends "base.html" %}

{% block title %}Dashboard | spoo.me{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}?v=1">
<script src="{{ url_for('static', filename='js/customNotification.js') }}?v=3"></script>
<meta name="robots" content="noindex">
{% endblock %}

{% block content %}
<div id="dashboard-root" class="dashboard" data-host="{{ host_url }}">
    <aside class="sidebar">
        <div class="brand">
            <div class="logo-circle">{{ (user.user_name or user.email)[:2]|upper }}</div>
            <div class="brand-text">
                <div class="title">{{ user.user_name or user.email }}</div>
                <div class="subtitle">Dashboard</div>
            </div>
        </div>
        <nav class="nav">
            <a class="nav-item active" href="#links" data-tab="links">
                <span class="dot"></span>
                <span>All Links</span>
            </a>
            <a class="nav-item" href="/dashboard/keys">
                <span class="dot"></span>
                <span>API Keys</span>
            </a>
            <a class="nav-item disabled" tabindex="-1">
                <span class="dot"></span>
                <span>Settings</span>
            </a>
        </nav>
        <div class="sidebar-footer">
            <button class="btn btn-ghost" onclick="logout()">Logout</button>
        </div>
    </aside>

    <section class="content">
        <header class="content-header">
            <h1>All Links</h1>
            <p>Manage and explore your links. Filter, sort, and paginate results from your account.</p>
        </header>

        <div class="toolbar surface">
            <div class="filters compact">
                <div class="field search">
                    <input id="f-search" type="text" placeholder="Search alias or destination…" autocomplete="off">
                </div>
            </div>
            <div class="toolbar-actions">
                <div class="options">
                    <button id="btn-options" class="btn"><span class="label">Options</span><span
                            class="caret">▾</span></button>
                    <div id="options-dropdown" class="options-dropdown" style="display:none">
                        <div class="options-grid">
                            <div class="field">
                                <label>Status</label>
                                <select id="f-status">
                                    <option value="">All</option>
                                    <option value="ACTIVE">ACTIVE</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>Password</label>
                                <select id="f-password">
                                    <option value="">All</option>
                                    <option value="true">With password</option>
                                    <option value="false">Without password</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>Max clicks</label>
                                <select id="f-maxclicks">
                                    <option value="">All</option>
                                    <option value="true">Set</option>
                                    <option value="false">Not set</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>Created after</label>
                                <input id="f-created-after" type="datetime-local">
                            </div>
                            <div class="field">
                                <label>Created before</label>
                                <input id="f-created-before" type="datetime-local">
                            </div>
                            <div class="field">
                                <label>Sort by</label>
                                <select id="f-sortby">
                                    <option value="created_at">Created</option>
                                    <option value="last_click">Last click</option>
                                    <option value="total_clicks">Total clicks</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>Order</label>
                                <select id="f-order">
                                    <option value="descending">Descending</option>
                                    <option value="ascending">Ascending</option>
                                </select>
                            </div>
                            <div class="field">
                                <label>Page size</label>
                                <select id="f-pagesize">
                                    <option value="10">10</option>
                                    <option value="20" selected>20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                </select>
                            </div>
                        </div>
                        <div class="options-actions">
                            <button id="btn-apply" class="btn btn-primary">Apply</button>
                            <button id="btn-reset" class="btn btn-ghost">Reset</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="list-container" class="list-container surface">
            <div id="list-loading" class="loading">Loading…</div>
            <div id="list-empty" class="empty" style="display:none">No links found.</div>
            <div id="links-list" class="links"></div>
        </div>

        <footer class="pagination-bar surface" id="pagination" style="display:none"></footer>
    </section>
</div>

<template id="tpl-link-item">
    <div class="link-item fade-in">
        <div class="link-main">
            <a class="link-short" target="_blank" rel="noopener"></a>
            <div class="link-long" title=""></div>
        </div>
        <div class="link-meta">
            <span class="chip status"></span>
            <span class="chip password" title="Password protected" style="display:none">Password</span>
            <span class="chip max-clicks" style="display:none"></span>
            <span class="chip private-stats" title="Private stats" style="display:none">Private stats</span>
        </div>
        <div class="link-stats">
            <div class="stat"><span class="label">Created</span><span class="value created"></span></div>
            <div class="stat"><span class="label">Last click</span><span class="value last-click"></span></div>
            <div class="stat"><span class="label">Total clicks</span><span class="value total-clicks"></span></div>
        </div>
    </div>
</template>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/dashboard.js') }}?v=1" defer></script>
{% endblock %}